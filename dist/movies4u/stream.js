"use strict";var __awaiter=this&&this.__awaiter||function(thisArg,_arguments,P,generator){return new(P||(P=Promise))(function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator.throw(value))}catch(e){reject(e)}}function step(result){var value;result.done?resolve(result.value):(value=result.value,value instanceof P?value:new P(function(resolve){resolve(value)})).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())})};Object.defineProperty(exports,"__esModule",{value:!0}),exports.getStream=getStream;const headers={Accept:"text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7","Cache-Control":"no-store","Accept-Language":"en-US,en;q=0.9",DNT:"1","sec-ch-ua":'"Not_A Brand";v="8", "Chromium";v="120", "Microsoft Edge";v="120"',"sec-ch-ua-mobile":"?0","sec-ch-ua-platform":'"Windows"',"Sec-Fetch-Dest":"document","Sec-Fetch-Mode":"navigate","Sec-Fetch-Site":"none","Sec-Fetch-User":"?1",Cookie:"xla=s4t; _ga=GA1.1.1081149560.1756378968; _ga_BLZGKYN5PF=GS2.1.s1756378968$o1$g1$t1756378984$j44$l0$h0","Upgrade-Insecure-Requests":"1","User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/131.0.0.0 Safari/537.36 Edg/131.0.0.0"};function getStream(_a){return __awaiter(this,arguments,void 0,function*({link:link,type:type,signal:signal,providerContext:providerContext}){const{axios:axios,cheerio:cheerio}=providerContext;try{const streamLinks=[];if(!link||link.includes("how-to-download")||link.includes("movies4u.ps/")||link.includes("gdtot"))return[];if(link.includes(".mp4")||link.includes(".mkv")||link.includes(".avi"))return streamLinks.push({server:"direct",link:link,type:link.split(".").pop()||"mp4"}),streamLinks;try{if(link.includes("hubcloud")){const{hubcloudExtracter:hubcloudExtracter}=require("../../dist/hubcloudExtractor.js"),extractedStreams=yield hubcloudExtracter(link,signal);if(extractedStreams&&extractedStreams.length>0)return extractedStreams.map(stream=>({server:stream.server,link:stream.link,type:stream.type,quality:void 0}))}else if(link.includes("gdflix")){const{gdFlixExtracter:gdFlixExtracter}=require("../../dist/gdflixExtractor.js"),extractedStreams=yield gdFlixExtracter(link,signal);if(extractedStreams&&extractedStreams.length>0)return extractedStreams.map(stream=>({server:stream.server,link:stream.link,type:stream.type,quality:void 0}))}else if(link.includes("gdtot"))return[]}catch(extractorError){}try{const response=yield axios.get(link,{headers:Object.assign(Object.assign({},headers),{Referer:"https://movies4u.ps/"}),signal:signal,timeout:1e4}),$=cheerio.load(response.data),foundLinks=new Set;if($("a[href]").each((i,el)=>{const href=$(el).attr("href"),textLower=$(el).text().trim().toLowerCase();if(!href||foundLinks.has(href))return;if(href.includes("javascript:")||href.includes("#")||href===link||href.includes("how-to-download")||href.includes("admin")||href.includes("login")||href.includes("register")||href.includes("account")||href.includes("report")||href.includes("telegram")||href.includes("twitter")||href.includes("facebook")||href.includes("instagram")||href.includes("youtube")||href.includes("tutorial")||href.includes("help")||href.includes("support")||href.includes("contact")||href.includes("privacy")||href.includes("terms")||href.includes("about")||href.includes("home")||href.includes("blog")||href.includes("news")||href.includes("tinyurl")||href.includes("amp-project")||href.includes("cdn.")||href.includes("api/")||href.includes("token=")||href.includes("gamerxyt.com")||href.includes("t.me/")||textLower.includes("create")||textLower.includes("login")&&!textLower.includes("no-login")||textLower.includes("register")||textLower.includes("account")||textLower.includes("report")||textLower.includes("telegram")||textLower.includes("tutorial")||textLower.includes("help")||textLower.includes("support")||textLower.includes("contact")||textLower.includes("privacy")||textLower.includes("terms")||textLower.includes("about")||textLower.includes("home")||textLower.includes("blog")||textLower.includes("news"))return;if(!(href.includes(".mp4")||href.includes(".mkv")||href.includes(".avi")||href.includes(".mov")||href.includes(".wmv")||href.includes(".flv")||href.includes("gdflix")||href.includes("hubcloud")||href.includes("mega")||href.includes("dropbox")||href.includes("mediafire")||href.includes("zippyshare")||href.includes("gofile")||href.includes("filepress")||href.includes("filebee")||textLower.includes("download")||textLower.includes("download now")||textLower.includes("download file")||textLower.includes("get file")||textLower.includes("stream")||textLower.includes("watch")||textLower.includes("play")||textLower.includes("view")||textLower.includes("hub-cloud")||textLower.includes("g-drive")||textLower.includes("no-login")||textLower.includes("gdflix")||textLower.includes("hubcloud")||textLower.includes("480p")||textLower.includes("720p")||textLower.includes("1080p")||textLower.includes("4k")||textLower.includes("hd")||textLower.includes("bluray")||textLower.includes("web-dl")||textLower.includes("hdtc")||textLower.includes("dvdrip")||textLower.includes("brrip")))return;let server="unknown";href.includes("gdflix")?server="gdflix":href.includes("hubcloud")||href.includes("hubcloud.fit")||href.includes("hubcloud.fans")?server="hubcloud":href.includes("nexdrive")?server="nexdrive":href.includes("filepress")||href.includes("filebee")?server="filepress":href.includes("mega")?server="mega":href.includes("drive")&&!href.includes("hubcloud")?server="gdrive":href.includes("dropbox")?server="dropbox":href.includes("mediafire")?server="mediafire":href.includes("zippyshare")?server="zippyshare":href.includes("gofile")?server="gofile":href.includes("upload")?server="upload":(href.includes(".mp4")||href.includes(".mkv")||href.includes(".avi"))&&(server="direct");let quality,fileType="mp4";href.includes(".mkv")?fileType="mkv":href.includes(".avi")?fileType="avi":href.includes(".mov")?fileType="mov":href.includes(".wmv")?fileType="wmv":href.includes(".flv")?fileType="flv":textLower.includes("mkv")?fileType="mkv":textLower.includes("avi")&&(fileType="avi"),textLower.includes("1080p")||href.includes("1080p")?quality="1080":textLower.includes("720p")||href.includes("720p")?quality="720":textLower.includes("480p")||href.includes("480p")?quality="480":textLower.includes("4k")||href.includes("4k")||textLower.includes("2160p")||href.includes("2160p")?quality="2160":(textLower.includes("360p")||href.includes("360p"))&&(quality="360"),streamLinks.push({server:server,link:href,type:fileType,quality:quality}),foundLinks.add(href)}),$("video source, video").each((i,el)=>{const src=$(el).attr("src")||$(el).attr("data-src");src&&!foundLinks.has(src)&&(streamLinks.push({server:"direct",link:src,type:src.split(".").pop()||"mp4"}),foundLinks.add(src))}),0===streamLinks.length){const pageText=response.data;[/https?:\/\/[^\s"']+\.(mp4|mkv|avi|mov|wmv|flv)(?:\?[^\s"']*)?/gi,/https?:\/\/[^\s"']*(?:gdflix|mega|dropbox|mediafire|zippyshare|gofile|filepress)[^\s"']*(?:\/file\/|\/download\/|\/d\/)[^\s"']*/gi,/https?:\/\/[^\s"']*drive[^\s"']*(?:\/file\/|\/d\/)[^\s"']*/gi].forEach(pattern=>{const matches=pageText.match(pattern);matches&&matches.forEach(match=>{if(!foundLinks.has(match)&&!(match.includes(".css")||match.includes(".js")||match.includes(".png")||match.includes(".jpg")||match.includes(".jpeg")||match.includes(".gif")||match.includes(".ico")||match.includes(".svg")||match.includes("wp-content")||match.includes("wp-includes")||match.includes("bootstrap")||match.includes("jquery")||match.includes("style.min")||match.includes("bundle.")||match.includes("admin")||match.includes("login")||match.includes("register")||match.includes("account")||match.includes("report")||match.includes("telegram")||match.includes("tutorial")||match.includes("help")||match.includes("support")||match.includes("contact")||match.includes("privacy")||match.includes("terms")||match.includes("about")||match.includes("home")||match.includes("blog")||match.includes("news")||match.includes("token=")||match.includes("api/")||match.includes("cdn.")||match.includes("amp-project")||match.includes("tinyurl")||match.includes("t.me/")||match.includes("gamerxyt.com")||match.includes("hubcloud.fit")||match.includes("hubcloud.fans"))){let server="extracted";match.includes("gdflix")?server="gdflix":match.includes("mega")?server="mega":match.includes("dropbox")?server="dropbox":match.includes("mediafire")?server="mediafire":match.includes("zippyshare")?server="zippyshare":match.includes("gofile")?server="gofile":match.includes("filepress")?server="filepress":match.includes("drive")&&!match.includes("hubcloud")?server="gdrive":(match.includes(".mp4")||match.includes(".mkv")||match.includes(".avi"))&&(server="direct");let fileType="mp4";match.includes(".mkv")?fileType="mkv":match.includes(".avi")?fileType="avi":match.includes(".mov")?fileType="mov":match.includes(".wmv")?fileType="wmv":match.includes(".flv")&&(fileType="flv"),streamLinks.push({server:server,link:match,type:fileType}),foundLinks.add(match)}})})}}catch(error){}return streamLinks}catch(error){return[]}})}